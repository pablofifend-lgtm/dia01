<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√≥dulo Lunar - Sistema de An√°lisis de Minerales</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #581c87 50%, #1e293b 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #1e293b;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            padding: 40px;
            border: 2px solid #a855f7;
        }

        h1 {
            color: #d8b4fe;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .astronauta-info {
            color: #cbd5e1;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .controles {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        label {
            color: #d8b4fe;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        select, input {
            background: #334155;
            color: white;
            border: 1px solid #a855f7;
            padding: 10px;
            border-radius: 6px;
            font-size: 1em;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #d8b4fe;
        }

        .formulario {
            background: #334155;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid #a855f7;
        }

        .formulario h2 {
            color: #d8b4fe;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .form-field {
            display: flex;
            flex-direction: column;
        }

        .form-field label {
            color: #e9d5ff;
            margin-bottom: 5px;
        }

        .form-field input,
        .form-field select {
            background: #475569;
            border: 1px solid #a855f7;
        }

        .input-error {
            border: 2px solid #ef4444 !important;
        }

        button {
            width: 100%;
            background: #9333ea;
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
            margin-bottom: 30px;
        }

        button:hover {
            background: #7c3aed;
        }

        .resultado {
            border-radius: 12px;
            padding: 30px;
            border: 3px solid;
            margin-bottom: 30px;
        }

        .resultado.valido {
            background: #064e3b;
            border-color: #10b981;
        }

        .resultado.invalido {
            background: #7f1d1d;
            border-color: #ef4444;
        }

        .resultado-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .resultado-header h3 {
            color: white;
            font-size: 1.8em;
        }

        .emoticon {
            font-size: 4em;
        }

        .resultado-contenido {
            background: #1e293b;
            padding: 20px;
            border-radius: 8px;
            color: white;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            font-size: 0.95em;
        }

        .criterios-info {
            background: #334155;
            border: 2px solid #eab308;
            border-radius: 8px;
            padding: 20px;
        }

        .criterios-info h4 {
            color: #fde047;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .criterios-info p {
            color: #cbd5e1;
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåô M√≥dulo Lunar</h1>
        <div class="astronauta-info" id="astronautaInfo"></div>

        <div class="controles">
            <div class="control-group">
                <label>Tipo de Entrada</label>
                <select id="tipoEntrada" onchange="cambiarTipoEntrada()">
                    <option value="extendida">Extendida (con labels)</option>
                    <option value="reducida">Reducida (placeholder)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Criterio de Validaci√≥n</label>
                <select id="validador">
                    <option value="igneo">Criterio √çgneo</option>
                    <option value="metamorfico">Criterio Metam√≥rfico</option>
                    <option value="sedimentario">Criterio Sedimentario</option>
                </select>
            </div>

            <div class="control-group">
                <label>Formato de Salida</label>
                <select id="formatoSalida">
                    <option value="europeo">Formato Europeo (ES/¬∞C)</option>
                    <option value="americano">Formato Americano (EN/¬∞F)</option>
                </select>
            </div>
        </div>

        <div class="formulario">
            <h2 id="tituloFormulario">üìã Formulario Extendido</h2>
            <div class="form-grid" id="formGrid"></div>
        </div>

        <button onclick="analizarRoca()">üî¨ Analizar Roca</button>

        <div id="resultadoDiv" class="hidden"></div>

        <div class="criterios-info">
            <h4>üìã Criterios de Validaci√≥n:</h4>
            <p><strong>√çgneo:</strong> Grupo √≠gneas + Grano muy grueso</p>
            <p><strong>Metam√≥rfico:</strong> Grupo metam√≥rficas + Grano medio/fino + Textura v√≠trea</p>
            <p><strong>Sedimentario:</strong> Grupo sedimentarias + Textura faner√≠tica</p>
        </div>
    </div>

    <script>
        // Interfaces y Clases
        class Astronauta {
            constructor(identificador, nombreCompleto, edad) {
                this.identificador = identificador;
                this.nombreCompleto = nombreCompleto;
                this.edad = edad;
            }

            dameId() {
                return this.identificador;
            }

            dameNombre() {
                return this.nombreCompleto;
            }

            dameEdad() {
                return this.edad;
            }
        }

        class ValidadorIgneo {
            isValid(roca) {
                return roca.grupo === 'igneas' && roca.tamanoGrano === 'muy_grueso';
            }

            getNombre() {
                return 'Criterio √çgneo';
            }
        }

        class ValidadorMetamorfico {
            isValid(roca) {
                return roca.grupo === 'metamorficas' && 
                       (roca.tamanoGrano === 'medio' || roca.tamanoGrano === 'fino') &&
                       roca.textura === 'vitrea';
            }

            getNombre() {
                return 'Criterio Metam√≥rfico';
            }
        }

        class ValidadorSedimentario {
            isValid(roca) {
                return roca.grupo === 'sedimentarias' && roca.textura === 'faneritica';
            }

            getNombre() {
                return 'Criterio Sedimentario';
            }
        }

        class EntradaExtendida {
            getTipo() {
                return 'extendida';
            }
        }

        class EntradaReducida {
            getTipo() {
                return 'reducida';
            }
        }

        class SalidaAmericana {
            muestra(roca) {
                const tempFahrenheit = (roca.temperaturaFormacion * 9/5) + 32;
                
                const grupoEN = {
                    igneas: 'Igneous',
                    metamorficas: 'Metamorphic',
                    sedimentarias: 'Sedimentary'
                };
                
                const tamanoGranoEN = {
                    muy_grueso: 'Very coarse grain',
                    grueso: 'Coarse grain',
                    medio: 'Medium grain',
                    fino: 'Fine grain'
                };
                
                const texturaEN = {
                    vitrea: 'Glassy',
                    afanitica: 'Aphanitic',
                    faneritica: 'Phaneritic'
                };

                return `Rock ID: ${roca.id}
Name: ${roca.nombre}
Group: ${grupoEN[roca.grupo]}
Hardness: ${roca.dureza} (Mohs)
Grain size: ${tamanoGranoEN[roca.tamanoGrano]}
Crystal size: ${roca.tamanoCristales}
Formation temp: ${tempFahrenheit.toFixed(1)}¬∞F
Texture: ${texturaEN[roca.textura]}
Structure: ${roca.estructura}
Grain shape: ${roca.formaGranos}`;
            }
        }

        class SalidaEuropea {
            muestra(roca) {
                const tempCelsius = roca.temperaturaFormacion - 273.15;
                
                const tamanoGranoES = {
                    muy_grueso: 'Grano muy grueso',
                    grueso: 'Grano grueso',
                    medio: 'Grano medio',
                    fino: 'Grano fino'
                };
                
                const texturaES = {
                    vitrea: 'V√≠trea',
                    afanitica: 'Afan√≠tica',
                    faneritica: 'Faner√≠tica'
                };

                return `ID Roca: ${roca.id}
Nombre: ${roca.nombre}
Grupo: ${roca.grupo.charAt(0).toUpperCase() + roca.grupo.slice(1)}
Dureza: ${roca.dureza} (Mohs)
Tama√±o grano: ${tamanoGranoES[roca.tamanoGrano]}
Tama√±o cristales: ${roca.tamanoCristales}
Temp. formaci√≥n: ${tempCelsius.toFixed(1)}¬∞C
Textura: ${texturaES[roca.textura]}
Estructura: ${roca.estructura}
Forma granos: ${roca.formaGranos}`;
            }
        }

        class Mision {
            constructor(piloto, validador, entrada, salida) {
                this.piloto = piloto;
                this.validador = validador;
                this.entrada = entrada;
                this.salida = salida;
            }

            analiza(roca) {
                const esValida = this.validador.isValid(roca);
                
                if (esValida) {
                    return {
                        valida: true,
                        mensaje: this.salida.muestra(roca)
                    };
                }
                
                return {
                    valida: false,
                    mensaje: `La roca no cumple con ${this.validador.getNombre()}`
                };
            }
        }

        // Variables globales
        const piloto = new Astronauta("AG001", "Agmunsen P√©rez", 45);
        let rocaActual = {
            id: '',
            nombre: '',
            grupo: 'igneas',
            dureza: 5,
            tamanoGrano: 'medio',
            clasificacion: 'construccion',
            tamanoCristales: 5,
            temperaturaFormacion: 300,
            estructura: '',
            formaGranos: '',
            textura: 'vitrea'
        };

        // Inicializaci√≥n
        document.getElementById('astronautaInfo').textContent = 
            `Astronauta: ${piloto.dameNombre()} | ID: ${piloto.dameId()} | Edad: ${piloto.dameEdad()} a√±os`;

        function validarId(id) {
            const regex = /^[A-Z]{2}\d{4}[A-Z]{2}$/;
            return regex.test(id);
        }

        function cambiarTipoEntrada() {
            const tipo = document.getElementById('tipoEntrada').value;
            document.getElementById('tituloFormulario').textContent = 
                tipo === 'extendida' ? 'üìã Formulario Extendido' : 'üìù Formulario Reducido';
            renderFormulario(tipo);
        }

        function renderFormulario(tipo) {
            const formGrid = document.getElementById('formGrid');
            formGrid.innerHTML = '';

            if (tipo === 'extendida') {
                formGrid.innerHTML = `
                    <div class="form-field">
                        <label>ID (LLDDDDLL):</label>
                        <input type="text" id="id" value="" oninput="actualizarRoca('id', this.value.toUpperCase())">
                    </div>
                    <div class="form-field">
                        <label>Nombre:</label>
                        <input type="text" id="nombre" value="" oninput="actualizarRoca('nombre', this.value)">
                    </div>
                    <div class="form-field">
                        <label>Grupo/Origen:</label>
                        <select id="grupo" onchange="actualizarRoca('grupo', this.value)">
                            <option value="igneas">√çgneas</option>
                            <option value="metamorficas">Metam√≥rficas</option>
                            <option value="sedimentarias">Sedimentarias</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label>Dureza (1-10):</label>
                        <input type="number" min="1" max="10" id="dureza" value="5" oninput="actualizarRoca('dureza', parseInt(this.value))">
                    </div>
                    <div class="form-field">
                        <label>Tama√±o de Grano:</label>
                        <select id="tamanoGrano" onchange="actualizarRoca('tamanoGrano', this.value)">
                            <option value="muy_grueso">Muy grueso (&gt;30mm)</option>
                            <option value="grueso">Grueso (5-30mm)</option>
                            <option value="medio" selected>Medio (2-5mm)</option>
                            <option value="fino">Fino (&lt;2mm)</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label>Tama√±o Cristales (0-10):</label>
                        <input type="number" min="0" max="10" id="tamanoCristales" value="5" oninput="actualizarRoca('tamanoCristales', parseInt(this.value))">
                    </div>
                    <div class="form-field">
                        <label>Temp. Formaci√≥n (K):</label>
                        <input type="number" id="temperaturaFormacion" value="300" oninput="actualizarRoca('temperaturaFormacion', parseInt(this.value))">
                    </div>
                    <div class="form-field">
                        <label>Textura:</label>
                        <select id="textura" onchange="actualizarRoca('textura', this.value)">
                            <option value="vitrea" selected>V√≠trea</option>
                            <option value="afanitica">Afan√≠tica</option>
                            <option value="faneritica">Faner√≠tica</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label>Estructura:</label>
                        <input type="text" id="estructura" value="" oninput="actualizarRoca('estructura', this.value)">
                    </div>
                    <div class="form-field">
                        <label>Forma de Granos:</label>
                        <input type="text" id="formaGranos" value="" oninput="actualizarRoca('formaGranos', this.value)">
                    </div>
                `;
            } else {
                formGrid.innerHTML = `
                    <input type="text" placeholder="ID (ej: AB1234CD)" id="id" value="${rocaActual.id}" oninput="actualizarRoca('id', this.value.toUpperCase())">
                    <input type="text" placeholder="Nombre del mineral" id="nombre" value="${rocaActual.nombre}" oninput="actualizarRoca('nombre', this.value)">
                    <select id="grupo" onchange="actualizarRoca('grupo', this.value)">
                        <option value="igneas" ${rocaActual.grupo === 'igneas' ? 'selected' : ''}>√çgneas</option>
                        <option value="metamorficas" ${rocaActual.grupo === 'metamorficas' ? 'selected' : ''}>Metam√≥rficas</option>
                        <option value="sedimentarias" ${rocaActual.grupo === 'sedimentarias' ? 'selected' : ''}>Sedimentarias</option>
                    </select>
                    <input type="number" placeholder="Dureza (1-10)" min="1" max="10" id="dureza" value="${rocaActual.dureza}" oninput="actualizarRoca('dureza', parseInt(this.value))">
                    <select id="tamanoGrano" onchange="actualizarRoca('tamanoGrano', this.value)">
                        <option value="muy_grueso" ${rocaActual.tamanoGrano === 'muy_grueso' ? 'selected' : ''}>Muy grueso</option>
                        <option value="grueso" ${rocaActual.tamanoGrano === 'grueso' ? 'selected' : ''}>Grueso</option>
                        <option value="medio" ${rocaActual.tamanoGrano === 'medio' ? 'selected' : ''}>Medio</option>
                        <option value="fino" ${rocaActual.tamanoGrano === 'fino' ? 'selected' : ''}>Fino</option>
                    </select>
                    <input type="number" placeholder="Tama√±o cristales (0-10)" min="0" max="10" id="tamanoCristales" value="${rocaActual.tamanoCristales}" oninput="actualizarRoca('tamanoCristales', parseInt(this.value))">
                    <input type="number" placeholder="Temperatura (K)" id="temperaturaFormacion" value="${rocaActual.temperaturaFormacion}" oninput="actualizarRoca('temperaturaFormacion', parseInt(this.value))">
                    <select id="textura" onchange="actualizarRoca('textura', this.value)">
                        <option value="vitrea" ${rocaActual.textura === 'vitrea' ? 'selected' : ''}>V√≠trea</option>
                        <option value="afanitica" ${rocaActual.textura === 'afanitica' ? 'selected' : ''}>Afan√≠tica</option>
                        <option value="faneritica" ${rocaActual.textura === 'faneritica' ? 'selected' : ''}>Faner√≠tica</option>
                    </select>
                    <input type="text" placeholder="Estructura" id="estructura" value="${rocaActual.estructura}" oninput="actualizarRoca('estructura', this.value)">
                    <input type="text" placeholder="Forma de granos" id="formaGranos" value="${rocaActual.formaGranos}" oninput="actualizarRoca('formaGranos', this.value)">
                `;
            }
        }

        function actualizarRoca(campo, valor) {
            rocaActual[campo] = valor;
            
            if (campo === 'id') {
                const input = document.getElementById('id');
                if (!validarId(valor) && valor) {
                    input.classList.add('input-error');
                } else {
                    input.classList.remove('input-error');
                }
            }
        }

        function analizarRoca() {
            const validadorTipo = document.getElementById('validador').value;
            const formatoSalida = document.getElementById('formatoSalida').value;
            const tipoEntrada = document.getElementById('tipoEntrada').value;

            let validador;
            switch(validadorTipo) {
                case 'igneo':
                    validador = new ValidadorIgneo();
                    break;
                case 'metamorfico':
                    validador = new ValidadorMetamorfico();
                    break;
                case 'sedimentario':
                    validador = new ValidadorSedimentario();
                    break;
            }

            const entrada = tipoEntrada === 'extendida' ? new EntradaExtendida() : new EntradaReducida();
            const salida = formatoSalida === 'americano' ? new SalidaAmericana() : new SalidaEuropea();

            const mision = new Mision(piloto, validador, entrada, salida);
            const resultado = mision.analiza(rocaActual);

            mostrarResultado(resultado);
        }

        function mostrarResultado(resultado) {
            const resultadoDiv = document.getElementById('resultadoDiv');
            resultadoDiv.classList.remove('hidden');
            
            const claseValidez = resultado.valida ? 'valido' : 'invalido';
            const titulo = resultado.valida ? '‚úÖ Roca V√°lida' : '‚ùå Roca No V√°lida';
            const emoticon = resultado.valida ? 'üòä' : 'üò†';

            resultadoDiv.className = `resultado ${claseValidez}`;
            resultadoDiv.innerHTML = `
                <div class="resultado-header">
                    <h3>${titulo}</h3>
                    <div class="emoticon">${emoticon}</div>
                </div>
                <div class="resultado-contenido">${resultado.mensaje}</div>
            `;
        }

        // Inicializar formulario
        renderFormulario('extendida');
    </script>
</body>
</html>